</style>

<body><uni-app class="uni-app--maxwidth"><uni-page
            data-page="pages/regist/index"><!----><!----><uni-page-wrapper><uni-page-body>
                    <div class="container1">
                        <div class="title">Sign up</div>
                        <div class="wrap">
                            <div class="evan-form-container items"><!---->
                                <div class="item">
                                    <div class="evan-form-item-container evan-form-item-container--left"
                                        style="border-width: 0.5px;">
                                        <div class="evan-form-item-container__label">Telephone</div>
                                        <div class="evan-form-item-container__main"><uni-input class="form-input">
                                                <div class="uni-input-wrapper"><input name="username"
                                                        onchange="check_username()"
                                                        placeholder="Please enter the telephone" maxlength="140" step=""
                                                        enterkeyhint="done" autocomplete="off" type=""
                                                        class="uni-input-input"><!----></div>
                                            </uni-input></div>
                                    </div>
                                </div>
                                <div class="item">
                                    <div class="evan-form-item-container evan-form-item-container--left"
                                        style="border-width: 0.5px;">
                                        <div class="evan-form-item-container__label">password</div>
                                        <div class="evan-form-item-container__main"><uni-input class="form-input">
                                                <div class="uni-input-wrapper"><input name="password" maxlength="140"
                                                        step="" enterkeyhint="done" autocomplete="off" type="password"
                                                        class="uni-input-input" placeholder=" Enter password"><!---->
                                                </div>
                                            </uni-input><!----></div>
                                    </div>
                                </div>
                                <div class="item">
                                    <div class="evan-form-item-container evan-form-item-container--left"
                                        style="border-width: 0.5px;">
                                        <div class="evan-form-item-container__label">Payment </div>
                                        <div class="evan-form-item-container__main"><uni-input class="form-input">
                                                <div class="uni-input-wrapper"><input name="payment" id="payment"
                                                        readonly="readonly" maxlength="140" step="" enterkeyhint="done"
                                                        autocomplete="off" type="password"
                                                        class="uni-input-input  payment_btn"
                                                        placeholder="Payment Password"><!----></div>
                                            </uni-input><!----></div>
                                    </div>
                                </div>
                                <div><!-- ss-modal-active -->
                                    <div data-platform="windows" class="ss-modal-body ss-modal-H5Top ss-modal-H5Bottom">
                                        <div class="ss-modal ss-modal-bottom ss-modal-full">
                                            <div class="digital-keyboard-modal digital-keyboard-modal-1">
                                                <!----><uni-swiper class="dk-swiper">
                                                    <div class="uni-swiper-wrapper">
                                                        <div class="uni-swiper-slides">
                                                            <div class="uni-swiper-slide-frame"
                                                                style="width: 100%; height: 100%; transform: translate(0%, 0px) translateZ(0px);">
                                                                <uni-swiper-item
                                                                    style="position: absolute; width: 100%; height: 100%; transform: translate(0%, 0px) translateZ(0px);">
                                                                    <div class="dk-title">Enter payment password</div>
                                                                    <div class="dk-subtitle">Enter payment password
                                                                    </div>
                                                                    <div class="pwd-box clearfix">
                                                                        <div data-index="0" class="pwd-text active">
                                                                        </div>
                                                                        <div data-index="1" class="pwd-text"></div>
                                                                        <div data-index="2" class="pwd-text"></div>
                                                                        <div data-index="3" class="pwd-text"></div>
                                                                        <div data-index="4" class="pwd-text"></div>
                                                                        <div data-index="5" class="pwd-text"></div>
                                                                    </div>
                                                                </uni-swiper-item></div>
                                                        </div>
                                                    </div>
                                                </uni-swiper><!---->
                                                <div class="pwd-forget"></div>
                                                <div class="digital-keyboard digital-keyboard-show"><!---->
                                                    <div class="digital-key-box clearfix">
                                                        <div class="num">1</div>
                                                        <div class="num">2</div>
                                                        <div class="num">3</div>
                                                        <div class="num">4</div>
                                                        <div class="num">5</div>
                                                        <div class="num">6</div>
                                                        <div class="num">7</div>
                                                        <div class="num">8</div>
                                                        <div class="num">9</div>
                                                        <div class="num no-num"></div>
                                                        <div class="num">0</div>
                                                        <div class="num no-num">-1</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div catchtouchmove="true" class="uni-mask"></div>
                                    </div>
                                </div>
                                <div class="item">
                                    <div class="evan-form-item-container evan-form-item-container--left"
                                        style="border-width: 0.5px;">
                                        <div class="evan-form-item-container__label">Invite</div>
                                        <div class="evan-form-item-container__main"><uni-input class="form-input">
                                                <div class="uni-input-wrapper"><input name="invite_code" maxlength="6"
                                                        step="0.000000000000000001" enterkeyhint="done" pattern="[0-9]*"
                                                        autocomplete="off" type="number" class="uni-input-input"
                                                        placeholder=" Invite code"><!----></div>
                                            </uni-input></div>
                                    </div>
                                </div>
                            </div>
                            <div class="btn reg" style="cursor:pointer;">Registered</div>
                            <div class="btn download"><a href="/index/login/index.html"> Already have an account?</a>
                            </div><!---->
                        </div>
                    </div>
                </uni-page-body></uni-page-wrapper></uni-page></uni-app></body>

</html>
<script src="/static/jquery.cookie.js"></script>
<script>
    $(function () {
        if ($.cookie("captcha")) {
            var count = $.cookie("captcha");
            $('#Send').text("(" + count + ")S").attr('disabled', true);
            var resend = setInterval(function () {
                count--;
                if (count > 0) {
                    $('#Send').text("(" + count + ")S").attr('disabled', true);
                    $.cookie("captcha", count, { path: '/', expires: (1 / 86400) * count });
                } else {
                    clearInterval(resend);
                    $('#Send').text("Send").addClass("active");
                }
            }, 1000);
        }

        $(document).on("click", ".active", function () {
            var phone = $("input[ name='phone']").val();
            var type = 1;
            if (phone && type) {
                layer.load(2);
                $.ajax({
                    url: "/index/login/sms_code.html",
                    type: "post",
                    traditional: true,
                    data: { phone: phone, type: type },
                    success: function (e) {
                        layer.closeAll('loading');
                        if (e.code === 1) {
                            layer.msg(e.msg);
                            var btn = $(this);
                            var count = 10;
                            var resend = setInterval(function () {
                                count--;
                                if (count > 0) {
                                    $('#Send').text("(" + count + ")S").attr('disabled', true);
                                    $('#Send').removeClass("active");
                                    $.cookie("captcha", count, { path: '/', expires: (1 / 86400) * count });
                                } else {
                                    clearInterval(resend);
                                    $('#Send').text("Send").addClass("active");
                                }
                            }, 1000);
                            btn.attr('disabled', true).css('cursor', 'not-allowed');
                        } else {
                            layer.msg(e.msg, function () {
                                return false;
                            });
                        }
                    },
                });
            } else {
                layer.msg('Mobile phone number cannot be empty', function () {
                });
            }
        });
    });
</script>
<script>
    function check_username() {
        var username = $("input[ name='username']").val();
        layer.load(2);
        $.ajax({
            url: "/index/login/check_username.html",
            type: "post",
            traditional: true,
            data: { username: username },
            success: function (e) {
                layer.closeAll('loading');
                if (e.code === 0) {
                    layer.msg(e.msg, function () {
                        $("input[ name='username']").val('');
                    });
                }
            },
        });
    }

    function check_phone() {
        var phone = $("input[ name='phone']").val();
        layer.load(2);
        $.ajax({
            url: "/index/login/check_phone.html",
            type: "post",
            traditional: true,
            data: { phone: phone },
            success: function (e) {
                layer.closeAll('loading');
                if (e.code === 0) {
                    layer.msg(e.msg, function () {
                        $("input[ name='phone']").val('');
                    });
                } else {
                    $("#Send").addClass("active");
                }
            },
        });
    }
</script>
<script>
    $(document).on("click", ".reg", function () {
        var username = $("input[ name='username']").val();
        var phone = $("input[ name='phone']").val();
        var code = $("input[ name='code']").val();
        var password = $("input[ name='password']").val();
        var payment = $("input[ name='payment']").val();
        var invite_code = $("input[ name='invite_code']").val();
        layer.load(2);
        $.ajax({
            url: "/index/login/reg.html",
            type: "post",
            traditional: true,
            data: { username: username, phone: phone, code: code, password: password, payment: payment, invite_code: invite_code },
            success: function (e) {
                layer.closeAll('loading');
                if (e.code === 1) {
                    layer.msg(e.msg, {
                        time: 2000,
                        end: function () {
                            window.location.href = "/index/login/index.html";
                        }
                    });
                } else {
                    layer.msg(e.msg, function () {
                        return false;
                    });
                }
            },
        });
    });
</script>
<script>
    window.onload = function () {
        //var id = $("#id").val();
        let $btn = document.querySelector('.payment_btn');
        let $ssModal = document.querySelector('.ss-modal-body');
        let $mask = document.querySelector('.uni-mask');
        let $keyboard = document.querySelectorAll('.digital-key-box .num');
        let $pwd = document.querySelectorAll('.pwd-box .pwd-text')
        let pwdArr = [];

        function modalOperation(type) {
            type && type == 'open' ?
                $ssModal.classList.add('ss-modal-active')
                : $ssModal.classList.remove('ss-modal-active');
        }
        $mask.addEventListener('click', modalOperation)
        $btn.addEventListener('click', () => {
            modalOperation('open');
        });

        $keyboard.forEach(element => {
            if (element.className.indexOf('no-num') == -1) {
                element.addEventListener('click', () => {
                    if (pwdArr.length < 6) {
                        $pwd[pwdArr.length].innerText = '*';
                        $pwd[pwdArr.length].classList.remove('active');
                        pwdArr.push(element.innerText);
                        $pwd[pwdArr.length] && $pwd[pwdArr.length].classList.add('active');
                        if (pwdArr.length == 6) {
                            var pass = pwdArr.join('');
                            $('#payment').val(pass);
                            modalOperation('close');
                        } else {
                            $('#payment').val('');
                        }
                    }
                })
            } else if (element.innerText == '-1') {
                element.addEventListener('click', () => {
                    console.log("delete", pwdArr.length);
                    if (pwdArr.length > 0) {
                        $pwd[pwdArr.length - 1].innerText = '';
                        $pwd[pwdArr.length - 1].classList.add('active')
                        $pwd[pwdArr.length] && $pwd[pwdArr.length].classList.remove('active')
                        pwdArr.pop()//移除一个元素
                        $('#payment').val('');
                    }
                })
            }
        });
    }
</script>